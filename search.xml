<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ZYNQå¹³å°_ARåˆé›†</title>
    <url>/2020/08/13/ZYNQ%E5%B9%B3%E5%8F%B0-AR%E5%90%88%E9%9B%86/</url>
    <content><![CDATA[<p>åœ¨ä½¿ç”¨zynq/zynqMPå¹³å°çš„æ—¶å€™ä¼šé‡åˆ°å½¢å½¢è‰²è‰²çš„é—®é¢˜, åœ¨ç¿»é˜…å¤§é‡çš„èµ„æ–™åå¯èƒ½å°±ä¼šæ‰¾åˆ°è§£å†³åŠæ³•, åœ¨æ­¤å°†è¿™äº›é—®é¢˜ä»¥åŠè§£å†³æ–¹æ¡ˆè®°å½•ä¸‹æ¥ä»¥å¤‡åç”¨.</p>
<span id="more"></span>
<h2 id="é—®é¢˜1">é—®é¢˜1</h2>
<p><strong>åœ¨vivadoä¸­ä½¿ç”¨HardWare Managerè°ƒè¯•èŠ¯ç‰‡ä¼šå¯¼è‡´å¼€å‘æ¿ä¸Šè¿è¡Œçš„Linuxç³»ç»Ÿå‡ºç°å„ç§é—®é¢˜,ä¾‹å¦‚æ­»æœºã€æ— æ³•å¯åŠ¨ç­‰ç­‰</strong></p>
<h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.å¦‚æœæ˜¯æ‰‹åŠ¨ç¼–è¯‘çš„æºç ,å¯ä»¥åœ¨bootargsé‡Œæ·»åŠ ä»¥ä¸‹é…ç½®: clk_ignore_unused cpuidle.off=1</span><br><span class="line">2.å¦‚æœæ˜¯ä½¿ç”¨Petalinux, åªéœ€è¦åœ¨å†…æ ¸é…ç½®ä¸­å–æ¶ˆå‹¾é€‰ä»¥ä¸‹é€‰é¡¹å³å¯:</span><br><span class="line">CPU Power Management --&gt; </span><br><span class="line">    CPU Idle ---&gt;</span><br><span class="line">        [ ] CPU idle PM support</span><br></pre></td></tr></table></figure>
<p>æ³¨:å‚è€ƒè‡ªXilinx <a href="https://www.xilinx.com/support/answers/69143.html">AR#69143</a></p>
<h2 id="é—®é¢˜2">é—®é¢˜2</h2>
<p><strong>ç”¨PetaLinux 2018.3ç‰ˆæœ¬ç¼–è¯‘çš„å¯åŠ¨æ–‡ä»¶åœ¨å¯åŠ¨æ—¶ä¼šæŠ¥é”™:â€œMMC:   sdhci_transfer_data: Error detected in status(0x208000)!â€,ä¹‹åç³»ç»Ÿæ— æ³•æ­£å¸¸å¯åŠ¨</strong></p>
<h3 id="è§£å†³æ–¹æ¡ˆ-v2">è§£å†³æ–¹æ¡ˆ</h3>
<p>è¿™ä¸ªé—®é¢˜å®é™…ä¸Šå®˜æ–¹ä¹‹å‰å·²ç»å‘ç°ï¼Œå¹¶ä¸”åœ¨petalinux2017.4ä¹‹åçš„ç‰ˆæœ¬è¿›è¡Œäº†ä¿®å¤<a href="https://www.xilinx.com/support/answers/69780.html?tdsourcetag=s_pcqq_aiomsg">AR#69780</a>ï¼Œä½†æ˜¯ä¿®å¤å¹¶æ²¡æœ‰å®Œå…¨è§£å†³é—®é¢˜ã€‚åœ¨ç‰ˆæœ¬ä¿®å¤ä¹‹å‰ï¼Œé—®é¢˜çš„æ¥æºæ˜¯åœ¨petalinux-configè®¾ç½®ä¸»SDä¸º1åï¼Œå¹¶æ²¡æœ‰èƒ½å¤ŸæˆåŠŸä¿®æ”¹ubootçš„å¯åŠ¨æŒ‡ä»¤ï¼Œæ•…ç»™å‡ºäº†AR69780ä¸­çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è§£å†³æ–¹æ¡ˆå¹¶ä¸å®Œç¾ã€‚</p>
<p>åªéœ€åœ¨project-spec/meta-user/recipes-bsp/u-boot/files/platform-top.h æ–‡ä»¶çš„æœ«å°¾åŠ å…¥ä¸‹é¢çš„ä»£ç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/*   fix codes  */</span><br><span class="line">#ifdef CONFIG_BOOTCOMMAND</span><br><span class="line">#undef CONFIG_BOOTCOMMAND</span><br><span class="line">#define CONFIG_BOOTCOMMAND	&quot;mmc dev $&#123;sdbootdev&#125;; run default_bootcmd&quot;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>ZYNQ</tag>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>GSTä½¿ç”¨ç¬”è®°</title>
    <url>/2020/07/28/GST%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>è¿™æ®µæ—¶é—´åœ¨Mpsocå¹³å°è°ƒè¯•äº†MIPI æ‘„åƒå¤´,åœ¨æ­¤è®°å½•ä¸‹å¦‚ä½•ä½¿ç”¨gst(gstreamer 1.0)å·¥å…·ç›´æ¥åœ¨DPç«¯å£ä¸Šæ˜¾ç¤ºæ‘„åƒå¤´é‡‡é›†çš„è§†é¢‘æˆ–è€…é€šè¿‡ç½‘ç»œæµä¼ è¾“åˆ°PCæ˜¾ç¤º.</p>
<p>æ“ä½œç³»ç»Ÿ: Ubuntu 18.04 LTS<br>
å¼€å‘æ¿  : MYIR Fx3<br>
å¼€å‘å·¥å…·: PetaLinux 2019.1</p>
<span id="more"></span>
<h2 id="1-å®‰è£…GST-1-0ç‰ˆæœ¬">1.å®‰è£…GST-1.0ç‰ˆæœ¬</h2>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤é…ç½®rootfs:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ petalinux-config -c rootfs:</span><br><span class="line">    Petalinux Package Groups --&gt;</span><br><span class="line">        packagegroup-petalinux-gstreamer --&gt;</span><br><span class="line">            packagegroup-petalinux-gstreamer</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ç®—æ˜¯å‹¾é€‰äº†Xilinxé›†æˆå¥½çš„gstå·¥å…·,ä½†æ˜¯è¿™å¥—å·¥å…·é»˜è®¤ä¸ä¼šå®‰è£…x264ç¼–è§£ç çš„æ’ä»¶,è¿˜éœ€è¦å¦è¡Œé…ç½®:</p>
<p><strong>a.ç¡®ä¿<Petalinux installed directory>/components/yocto/source/aarch64/layers/core/meta/recipes-multimedia/gstreamerç›®å½•ä¸‹æœ‰â€œ<a href="http://gst-plugins-ugly-1.14.4.bb">gst-plugins-ugly-1.14.4.bb</a>â€è¿™ä¸ªæ–‡ä»¶</strong><br>
<strong>b.åœ¨<petalinux-project-root>/project-spec/meta-user/recipes-core/images/petalinux-image.bbappendæ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">IMAGE_INSTALL_append = <span class="string">&quot; gstreamer1.0-plugins-ugly&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>c.åœ¨<petalinux-project-root>/project-spec/meta-user/conf/layer.confä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PACKAGECONFIG_append_pn-gstreamer1.0-plugins-ugly = <span class="string">&quot; x264&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>d.åœ¨<petalinux-project-root>/project-spec/meta-user/conf/petalinuxbsp.confä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">LICENSE_FLAGS_WHITELIST_append = <span class="string">&quot;commercial&quot;</span></span><br></pre></td></tr></table></figure>
<p><em>å¦‚æœä¸æ·»åŠ è¿™ä¸ªä¼šæŠ¥é”™:</em></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gstreamer1.0-libav was skipped: because it has a restricted license not whitelisted <span class="keyword">in</span> LICENSE_FLAGS_WHITELIST</span><br></pre></td></tr></table></figure>
<p><strong>e.é‡æ–°è¿è¡Œpetalinux-config -c rootfså‘½ä»¤,é€‰æ‹©:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ petalinux-config -c rootfs:</span><br><span class="line">    user packages --&gt;</span><br><span class="line">        gstreamer1.0-plugins-ugly</span><br></pre></td></tr></table></figure>
<h2 id="2-è§†é¢‘æµæµ‹è¯•">2.è§†é¢‘æµæµ‹è¯•</h2>
<p><strong>å°çƒæµ‹è¯•,éªŒè¯gståŠŸèƒ½æ˜¯å¦æ­£å¸¸:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gst-launch-1.0 -v videotestsrc pattern=ball name=left ! fbdevsink  </span><br></pre></td></tr></table></figure>
<p>æ³¨æ„:åœ¨ZYNQMPå¹³å°ä¸Š,åªèƒ½ç”¨fbdevsinkè¿™ä¸ªsink,ä½¿ç”¨autovideosinkæ— æ•ˆ.<br>
<strong>é€šè¿‡DPå£æ˜¾ç¤ºè§†é¢‘æµ:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gst-launch-1.0 v4l2src device=/dev/video1 ! <span class="string">&#x27;video/x-raw,width=1920,height=1080,framerate=30/1&#x27;</span> ! queue2 ! videorate ! videoscale ! videoconvert ! fbdevsink</span><br></pre></td></tr></table></figure>
<p><strong>å…¨å±æ˜¾ç¤º:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gst-launch-1.0 v4l2src device=/dev/video1 ! <span class="string">&#x27;video/x-raw,width=1920,height=1080,framerate=30/1&#x27;</span> ! queue2 ! videorate ! videoscale ! videoconvert ! kmssink bus-id=fd4a0000.zynqmp-display fullscreen-overlay=1  </span><br></pre></td></tr></table></figure>
<h2 id="3-ç½‘ç»œæµæµ‹è¯•">3.ç½‘ç»œæµæµ‹è¯•</h2>
<p><strong>zynqMPç«¯:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gst-launch-1.0 v4l2src device=/dev/video1 ! video/x-raw,width=1920,height=1080,framerate=5/1 ! videorate ! videoscale ! videoconvert ! x264enc ! h264parse config-interval=-1 ! rtph264pay ! udpsink host=192.168.30.218 port=5600</span><br></pre></td></tr></table></figure>
<p><strong>PCç«¯:</strong><br>
å…ˆåœ¨PCä¸Šå®‰è£…<a href="https://www.videolan.org/">VLCæ’­æ”¾å™¨</a>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å‘½åä¸ºtest.sdp,ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å¹¶å¡«ä¸Šä»¥ä¸‹å†…å®¹:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">m=video 5600 RTP/AVP 96</span><br><span class="line"></span><br><span class="line">a=rtpmap:96 H264</span><br><span class="line"></span><br><span class="line">a=framerate:15</span><br><span class="line"></span><br><span class="line">c=IN IP4 192.168.30.218</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨vlcæ’­æ”¾å™¨æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å³å¯æ¥æ”¶åˆ°zynqMPç«¯å‘å‡ºçš„ç½‘ç»œæµ</p>
<h2 id="4-ä¿å­˜è§†é¢‘æµä¸ºmp4">4.ä¿å­˜è§†é¢‘æµä¸ºmp4</h2>
<p><strong>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†è§†é¢‘æµä¿å­˜åˆ°mp4æ–‡ä»¶ä¸­:</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gst-launch-1.0 v4l2src device=/dev/video1 ! video/x-raw,width=1920,height=1080,framerate=15/1 ! videoconvert ! x264enc threads=4 sliced-threads=TRUE tune=zerolatency ! matroskamux ! filesink location = output1.mp4</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>ZYNQ</tag>
        <tag>Video</tag>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
      </tags>
  </entry>
  <entry>
    <title>é…ç½®Gadgetå®ç°USBå¤§å®¹é‡å­˜å‚¨</title>
    <url>/2020/06/15/%E9%85%8D%E7%BD%AEGadget%E5%AE%9E%E7%8E%B0USB%E5%A4%A7%E5%AE%B9%E9%87%8F%E5%AD%98%E5%82%A8/</url>
    <content><![CDATA[<p>åœ¨å¼€å‘æ¿ä¸ŠUSBç«¯å£é»˜è®¤éƒ½æ˜¯HOSTæ¨¡å¼,ä½†æ˜¯å¾ˆå¤šç”¨æˆ·éœ€è¦å°†USBé…ç½®æˆPeripheralæ¨¡å¼(æ¨¡æ‹ŸUç›˜),åœ¨æ­¤è®°å½•é…ç½®è¿‡ç¨‹.</p>
<p>æ“ä½œç³»ç»Ÿ: Ubuntu 18.04 LTS<br>
å¼€å‘æ¿  : MYIR Z-turn Board</p>
<span id="more"></span>
<h2 id="1-å†…æ ¸é…ç½®">1.å†…æ ¸é…ç½®</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ make menuconfig:</span><br><span class="line">    Device Drivers</span><br><span class="line">    USB support</span><br><span class="line">        &lt;*&gt; ChipIdea Highspeed Dual Role Controller</span><br><span class="line">        &lt;*&gt; ChipIdea device controller</span><br><span class="line">        &lt;*&gt; USB Gadget Support</span><br><span class="line">            &lt;M&gt; USB <span class="built_in">functions</span> configurable through configfs</span><br><span class="line">                [*] Mass storage</span><br><span class="line">            &lt;M&gt; USB Gadget precomposed configurations</span><br><span class="line">                &lt;M&gt; Mass Storage Gadget</span><br></pre></td></tr></table></figure>
<h2 id="2-è®¾å¤‡æ ‘é…ç½®">2.è®¾å¤‡æ ‘é…ç½®</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">usb_0: usb@e0002000 &#123;</span><br><span class="line">     compatible = <span class="string">&quot;xlnx,zynq-usb-2.20.a&quot;</span>, <span class="string">&quot;chipidea,usb2&quot;</span>;</span><br><span class="line">     clocks = &lt;&amp;clkc 28&gt;;</span><br><span class="line">     dr_mode = <span class="string">&quot;peripheral&quot;</span>;</span><br><span class="line">     interrupt-parent = &lt;&amp;intc&gt;;</span><br><span class="line">     interrupts = &lt;0 21 4&gt;;</span><br><span class="line">     reg = &lt;0xe0002000 0x1000&gt;;</span><br><span class="line">     usb-phy = &lt;&amp;usb_phy0&gt;;</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure>
<h2 id="3-ç¼–è¯‘">3.ç¼–è¯‘</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ make uImage</span><br><span class="line">$ make dtb</span><br><span class="line">$ make modules:</span><br><span class="line">    éœ€è¦ç”¨åˆ°è¿™å‡ ä¸ªæ¨¡å—: libcomposite.ko usb_f_mass_storage.ko g_mass_storage.ko</span><br></pre></td></tr></table></figure>
<h2 id="4-ä½¿ç”¨">4.ä½¿ç”¨</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ insmod libcomposite.ko</span><br><span class="line">$ insmod usb_f_mass_storage.ko</span><br><span class="line">$ insmod g_mass_storage.ko file=/dev/mmcblk0 removable=1</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºä»¥ä¸‹ä¿¡æ¯åˆ™è¡¨ç¤ºé…ç½®æˆåŠŸ:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Mass Storage Function, version: 2009/09/11</span><br><span class="line">LUN: removable file: (no medium)</span><br><span class="line">LUN: removable file: /dev/mmcblk0</span><br><span class="line">Number of LUNs=1</span><br><span class="line">g_mass_storage gadget: Mass Storage Gadget, version: 2009/09/11</span><br><span class="line">g_mass_storage gadget: userspace failed to provide iSerialNumber</span><br><span class="line">g_mass_storage gadget: g_mass_storage ready</span><br></pre></td></tr></table></figure>
<p>é©±åŠ¨åŠ è½½æˆåŠŸåå³å¯å°†å¼€å‘æ¿çš„USBå£ä¸ç”µè„‘è¿æ¥æŸ¥çœ‹æ•ˆæœ.</p>
]]></content>
      <tags>
        <tag>ZYNQ</tag>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
        <tag>ubuntu ç§»æ¤</tag>
      </tags>
  </entry>
  <entry>
    <title>ZYNQåœ¨å†…æ ¸å¯¹PLç¼–ç¨‹</title>
    <url>/2019/04/08/ZYNQ%E5%9C%A8%E5%86%85%E6%A0%B8%E5%AF%B9PL%E7%BC%96%E7%A8%8B/</url>
    <content><![CDATA[<p>åœ¨zynq7000ç³»åˆ—å¤„ç†å™¨ä¸Šå¯¹PLç¼–ç¨‹æœ‰ä¸‰ç§æ–¹å¼:<br>
1.ä½¿ç”¨fsbl,å°†bitstreamé›†æˆåˆ°boot.binä¸­<br>
2.ä½¿ç”¨ubootå‘½ä»¤<br>
3.åœ¨linuxå†…æ ¸ä¸­ä½¿ç”¨devcfgé©±åŠ¨</p>
<p>å‰ä¸¤ç§æ–¹å¼å¾ˆå¸¸ç”¨,ä¹Ÿå¾ˆç®€å•,æ‰€ä»¥æœ¬æ–‡åªä»‹ç»ç¬¬ä¸‰ç§æ–¹å¼</p>
<p>æ“ä½œç³»ç»Ÿ: Ubuntu 16.04 LTS<br>
å¼€å‘æ¿  : MYIR Z-turn Board<br>
å†…æ ¸ç‰ˆæœ¬: 4.14</p>
<span id="more"></span>
<h2 id="1-å°†æ¯”ç‰¹æµåº”è½¬æ¢ä¸ºäºŒè¿›åˆ¶">1.å°†æ¯”ç‰¹æµåº”è½¬æ¢ä¸ºäºŒè¿›åˆ¶</h2>
<p>æ³¨:è¿™éƒ¨åˆ†å†…å®¹å¼•ç”¨è‡ª<a href="https://china.xilinx.com/support/answers/46913.html">Xilinx AR#46913</a><br>
ä½¿ç”¨SDKé‡Œçš„bootgenå·¥å…·å¯å®Œæˆæ­¤æ“ä½œ,BootGen å·¥å…·ä½¿ç”¨â€œBIFâ€è¾“å…¥æ–‡ä»¶,å®ƒå¯æè¿°å¼•å¯¼æ˜ åƒçš„ç»“æ„.</p>
<h3 id="BIF-æ–‡ä»¶ç¤ºä¾‹">BIF æ–‡ä»¶ç¤ºä¾‹:</h3>
<pre><code>the_ROM_image:
&#123;
    [bootloader]&lt;fsbl_name&gt;.elf
    &lt;pl_bitstream_name&gt;.bit
    &lt;u-boot_name&gt;.elf
&#125;
</code></pre>
<p>åœ¨SDKä¸­æ‰“å¼€shell,æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯å°†bitstreamè½¬æ¢ä¸ºbin:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ bootgen -image fsbl.bif -w -process_bitstream bin</span><br></pre></td></tr></table></figure>
<p>å®Œæˆåå³å¯åœ¨bitstreamæ‰€åœ¨ç›®å½•æ‰¾åˆ°å¯¹åº”çš„binæ–‡ä»¶</p>
<h2 id="2-é…ç½®linux-kernel">2.é…ç½®linux kernel</h2>
<h3 id="åœ¨menuconfigä¸­ä¾æ¬¡é€‰æ‹©ä»¥ä¸‹é€‰é¡¹">åœ¨menuconfigä¸­ä¾æ¬¡é€‰æ‹©ä»¥ä¸‹é€‰é¡¹:</h3>
<pre><code>Device Drivers â†’ FPGA Configuration Framework
Device Drivers â†’ FPGA Configuration Framework â†’ FPGA Bridge Framwork
Device Drivers â†’ FPGA Configuration Framework â†’ FPGA Region
Device Drivers â†’ Device Tree overlays â†’ Device Tree Overlays ConfigFS interface
</code></pre>
<p>å…·ä½“é…ç½®è¯¦æƒ…å¯å‚è§<a href="https://xilinx-wiki.atlassian.net/wiki/spaces/A/pages/18841645/Solution+Zynq+PL+Programming+With+FPGA+Manager">Xilinx wiki</a></p>
<h2 id="3-å¯¹PLç¼–ç¨‹">3.å¯¹PLç¼–ç¨‹</h2>
<h3 id="3-1-ä½¿ç”¨sysfsæ¥å£">3.1 ä½¿ç”¨sysfsæ¥å£</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ mkdir -p /lib/firmware/</span><br><span class="line">$ cp design_1_wrapper.bit.bin /lib/firmware</span><br><span class="line">$ echo 8 &gt; /sys/class/fpga_manager/fpga0/flags</span><br><span class="line">$ echo design_1_wrapper.bit.bin &gt; /sys/class/fpga_manager/fpga0/firmware</span><br></pre></td></tr></table></figure>
<h3 id="3-2-ä½¿ç”¨fpgautilå·¥å…·">3.2 ä½¿ç”¨fpgautilå·¥å…·</h3>
<p><a href="https://xilinx-wiki.atlassian.net/wiki/download/attachments/18841847/fpgautil.c?version=2&amp;modificationDate=1549947129137&amp;cacheVersion=1&amp;api=v2">fpgautil</a>æ˜¯xilinxå®˜æ–¹ä¸ºMPSOCæä¾›çš„å·¥å…·,ä½†æ˜¯åœ¨zynq7000ä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ fpgautil -b ./design_1_wrapper.bit.bin</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ZYNQ</tag>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>ZYNQ 7000 CANè°ƒè¯•è®°å½•</title>
    <url>/2019/03/26/ZYNQ-7000-CAN%E8%B0%83%E8%AF%95%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>åœ¨zynq 7000å¹³å°CANè°ƒè¯•è¿‡ç¨‹ä¸­,é‡åˆ°äº†ä¸€äº›é—®é¢˜,åœ¨å‚é˜…xilinx Wikiå,é¡ºåˆ©è°ƒé€š,æ•…å°†è°ƒè¯•è¿‡ç¨‹è®°å½•ä¸‹æ¥ä»¥å¤‡åç”¨</p>
<p>æ“ä½œç³»ç»Ÿ: Ubuntu 16.04 LTS<br>
å¼€å‘æ¿  : MYIR Z-turn Board</p>
<span id="more"></span>
<h2 id="1-è¯´æ˜">1.è¯´æ˜</h2>
<p>CANæ˜¯æ§åˆ¶å™¨å±€åŸŸç½‘ç»œ(Controller Area Network, CAN)çš„ç®€ç§°,æ˜¯ç”±ä»¥ç ”å‘å’Œç”Ÿäº§æ±½è½¦ç”µå­äº§å“è‘—ç§°çš„å¾·å›½BOSCHå…¬å¸å¼€å‘çš„,å¹¶æœ€ç»ˆæˆä¸ºå›½é™…æ ‡å‡†ï¼ˆISO 11898ï¼‰,æ˜¯å›½é™…ä¸Šåº”ç”¨æœ€å¹¿æ³›çš„ç°åœºæ€»çº¿ä¹‹ä¸€.è¯¦æƒ…è¯·å‚è€ƒ<a href="https://baike.baidu.com/item/CAN%E6%80%BB%E7%BA%BF/297754?fr=aladdin">ç™¾ç§‘</a></p>
<h2 id="2-linux-kernelå’Œdevicetreeçš„é…ç½®">2.linux kernelå’Œdevicetreeçš„é…ç½®</h2>
<h3 id="2-1-Linux-kernelé…ç½®">2.1 Linux kernelé…ç½®</h3>
<p>åœ¨linux kernelä¸­,Xilinx CAN é©±åŠ¨é»˜è®¤æ˜¯disableçŠ¶æ€,æŒ‰ç…§ä¸‹å›¾æ‰“å¼€å¯¹åº”é€‰é¡¹å³å¯:<br>
<img src="../../../../images/Xilinx_CAN_Kernel_config.png" alt="avatar"></p>
<h3 id="2-2-Devicetreeé…ç½®">2.2 Devicetreeé…ç½®</h3>
<p>é€šè¿‡æŸ¥é˜…ç›¸å…³æ–‡æ¡£,Xilinx CAN driveråœ¨Devicetreeä¸­çš„é…ç½®å¦‚ä¸‹:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zynq_can_0: can@e0008000 &#123;</span><br><span class="line">    compatible = <span class="string">&quot;xlnx,zynq-can-1.0&quot;</span>;</span><br><span class="line">    clocks = &lt;&amp;clkc 19&gt;, &lt;&amp;clkc 36&gt;;</span><br><span class="line">    clock-names = <span class="string">&quot;can_clk&quot;</span>, <span class="string">&quot;pclk&quot;</span>;</span><br><span class="line">    reg = &lt;0xe0008000 0x1000&gt;;</span><br><span class="line">    interrupts = &lt;0 28 4&gt;;</span><br><span class="line">    interrupt-parent = &lt;&amp;intc&gt;;</span><br><span class="line">    tx-fifo-depth = &lt;0x40&gt;;</span><br><span class="line">    rx-fifo-depth = &lt;0x40&gt;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="3-canutilså’Œiproute2çš„ç¼–è¯‘ä»¥åŠä½¿ç”¨">3.canutilså’Œiproute2çš„ç¼–è¯‘ä»¥åŠä½¿ç”¨</h2>
<h3 id="3-1-canutilså·¥å…·çš„äº¤å‰ç¼–è¯‘">3.1 canutilså·¥å…·çš„äº¤å‰ç¼–è¯‘</h3>
<p>ä¸‹è½½æºç :<br>
<a href="https://public.pengutronix.de/software/libsocketcan/libsocketcan-0.0.11.tar.bz2">libsocketcan-0.0.11.tar.gz</a><br>
<a href="https://public.pengutronix.de/software/socket-can/canutils/v4.0/canutils-4.0.6.tar.bz2">canutils-4.0.6.tar.gz</a></p>
<p>äº¤å‰ç¼–è¯‘libsocketcan:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> libsocketcan-0.0.11</span><br><span class="line">$ ./configure CC=arm-linux-gnueabihf-gcc --host=arm-linux-gnueabihf --prefix=$(<span class="built_in">pwd</span>)/install</span><br><span class="line">$ make -j4</span><br><span class="line">$ make install</span><br></pre></td></tr></table></figure>
<p>äº¤å‰ç¼–è¯‘canutils:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> canutils-4.0.6</span><br><span class="line">$ ./configure CC=arm-linux-gnueabihf-gcc --host=arm-linux-gnueabihf --prefix=$(<span class="built_in">pwd</span>)/install libsocketcan_LIBS=-lsocketcan LDFLAGS=<span class="string">&quot;-L/home/Codes/libsocketcan-0.0.11/install/lib/&quot;</span> libsocketcan_CFLAGS=<span class="string">&quot;-I/home/Codeslibsocketcan-0.0.11/install/include/&quot;</span></span><br><span class="line">$ make -j4</span><br><span class="line">$ make install</span><br></pre></td></tr></table></figure>
<h3 id="3-2-iproute2å·¥å…·çš„äº¤å‰ç¼–è¯‘">3.2 iproute2å·¥å…·çš„äº¤å‰ç¼–è¯‘</h3>
<p>ä¸‹è½½æºç :<br>
<a href="https://mirrors.edge.kernel.org/pub/linux/utils/net/iproute2/iproute2-4.9.0.tar.gz">iproute2-4.9.0.tar.gz</a></p>
<p>é¦–å…ˆä¿®æ”¹æºç æ ¹ç›®å½•ä¸‹çš„Makefile:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å°†CCé‚£ä¸€è¡Œæ”¹ä¸º:</span><br><span class="line">CC := arm-linux-gnueabihf-gcc</span><br></pre></td></tr></table></figure>
<p>äº¤å‰ç¼–è¯‘:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ make -j4</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘è¿‡ç¨‹å¯èƒ½ä¼šå‡ºé”™,ä½†æ˜¯æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„ipå·¥å…·å·²ç¼–è¯‘å‡ºæ¥,å…¶å®ƒå·¥å…·å¹¶ä¸éœ€è¦,æ‰€ä»¥å¿½ç•¥é”™è¯¯å³å¯</p>
<h3 id="3-3æµ‹è¯•CANçš„åŠŸèƒ½">3.3æµ‹è¯•CANçš„åŠŸèƒ½</h3>
<p>ä»¥ä¸‹è°ƒè¯•è¿‡ç¨‹æ‘˜æŠ„è‡ª<a href="https://xilinx-wiki.atlassian.net/wiki/spaces/A/pages/18842496/Linux+CAN+driver">Xilinx Wiki</a>,ç»è¿‡éªŒè¯,æ­¤æ–¹æ³•å¯è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. Set bit-timing</span><br><span class="line">Can supports bitrates upto 1Mb/s. Xilinx CAN h/w and driver supports these bit rates</span><br><span class="line">Note: Triple sampling is not supported by Xilinx CAN H/W. </span><br><span class="line">$ ./ip <span class="built_in">link</span> <span class="built_in">set</span> can0 <span class="built_in">type</span> can bitrate 200000</span><br><span class="line">or</span><br><span class="line">$ ./canconfig can0 bitrate 200000</span><br><span class="line">2. Bring up the device</span><br><span class="line">$ ./ip <span class="built_in">link</span> <span class="built_in">set</span> can0 up</span><br><span class="line">or</span><br><span class="line">$ ./canconfig can0 start</span><br><span class="line">3. Bring down the device</span><br><span class="line">$ ./ip <span class="built_in">link</span> <span class="built_in">set</span> can0 down</span><br><span class="line">or</span><br><span class="line">$ ./canconfig can0 stop</span><br><span class="line">4. Transmit and receive packets with standard <span class="built_in">id</span> number</span><br><span class="line">$ ./cansend can0 -i 0x14 &lt;bytes&gt;</span><br><span class="line">$ ./candump can0</span><br><span class="line">5. Transmit and receive packets with extended <span class="built_in">id</span> number (--loop argument here)</span><br><span class="line">$ ./cansend can0 -i 0x333 &lt;bytes&gt;</span><br><span class="line">$ ./candump can0</span><br><span class="line">6. Loopback mode</span><br><span class="line">$ ./canconfig can0 ctrlmode loopback on </span><br><span class="line">7. Checking <span class="built_in">link</span> state (checking bitrate/errors/packets)</span><br><span class="line">$ ./ip -d -s <span class="built_in">link</span> show can0</span><br><span class="line">8. Checking net device state</span><br><span class="line">$ ifconfig can0</span><br><span class="line">9. Getting statistics via proc</span><br><span class="line">$ <span class="built_in">cat</span> /proc/net/can/stats</span><br><span class="line">10. Socket CAN core uses several filter lists to deliver received CAN frames to CAN protocol modules. These</span><br><span class="line">receive lists, their filters and the count of filter matches can be checked <span class="keyword">in</span> the appropriate receive list. All entries contain the</span><br><span class="line">device and a protocol module identifier:</span><br><span class="line">$ <span class="built_in">cat</span> /proc/net/can/rcvlist_all</span><br><span class="line">rcvlist_all - list <span class="keyword">for</span> unfiltered entries (no filter operations)</span><br><span class="line">rcvlist_eff - list <span class="keyword">for</span> single extended frame (EFF) entries</span><br><span class="line">rcvlist_err - list <span class="keyword">for</span> error message frames masks</span><br><span class="line">rcvlist_fil - list <span class="keyword">for</span> mask/value filters</span><br><span class="line">rcvlist_inv - list <span class="keyword">for</span> mask/value filters (inverse semantic)</span><br><span class="line">rcvlist_sff - list <span class="keyword">for</span> single standard frame (SFF) entries</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>ZYNQ</tag>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨armå¹³å°ç§»æ¤ntp</title>
    <url>/2019/03/13/ntp%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/</url>
    <content><![CDATA[<p>ç”±äºå·¥ä½œéœ€æ±‚,éœ€è¦åœ¨zynqå¹³å°ä½¿ç”¨ntpç›¸å…³ç¨‹åº,åœ¨ntpçš„ç§»æ¤è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›å‘,åœ¨æ­¤çºªå½•ä¸‹æ¥</p>
<p>æ“ä½œç³»ç»Ÿ: Ubuntu 16.04 LTS<br>
å¼€å‘æ¿  : MYIR Z-turn Board</p>
<span id="more"></span>
<h2 id="1-è¯´æ˜">1.è¯´æ˜</h2>
<p>ç½‘ç»œæ—¶é—´åè®®Network Time Protocol(NTP) æ˜¯ä¸€ç§ç¡®ä¿æ—¶é’Ÿä¿æŒå‡†ç¡®çš„æ–¹æ³•ã€‚å¦‚æœå¯ä»¥è®¿é—®äº’è”ç½‘ï¼Œåªéœ€å®‰è£…ntpçš„å®¢æˆ·ç«¯è½¯ä»¶åˆ°äº’è”ç½‘ä¸Šçš„å…¬å…±ntpæœåŠ¡å™¨è‡ªåŠ¨ä¿®æ­£æ—¶é—´å³å¯.å…·ä½“è¯´æ˜å¯å‚è€ƒç™¾ç§‘<a href="https://baike.baidu.com/item/NTP/1100433">NTP</a>.</p>
<h2 id="2-å‡†å¤‡å·¥ä½œ">2.å‡†å¤‡å·¥ä½œ</h2>
<p>ç”±äºntpåœ¨ä¾èµ–opensslåº“,æ‰€ä»¥åœ¨äº¤å‰ç¼–è¯‘ntpä¹‹å‰éœ€è¦å…ˆäº¤å‰ç¼–è¯‘openssl.<br>
<em><strong>æ³¨æ„:æ–°ç‰ˆæœ¬çš„ntpä¾èµ–1.1.1ç‰ˆæœ¬çš„openssl!!!</strong></em></p>
<h3 id="2-1ä¸‹è½½æºç ">2.1ä¸‹è½½æºç </h3>
<p><a href="http://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.8p13.tar.gz">ntp-4.2.8p13.tar.gz</a><br>
<a href="https://www.openssl.org/source/openssl-1.1.1b.tar.gz">openssl-1.1.1b.tar.gz</a></p>
<h3 id="2-2è§£å‹æºç ">2.2è§£å‹æºç </h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> -p ~/work &amp;&amp; <span class="built_in">cd</span> ~/work</span><br><span class="line">$ tar -xvf ntp-4.2.8p13.tar.gz</span><br><span class="line">$ tar -xvf openssl-1.1.1b.tar.gz</span><br></pre></td></tr></table></figure>
<h2 id="3-ç§»æ¤æ­¥éª¤">3.ç§»æ¤æ­¥éª¤</h2>
<h3 id="3-1-äº¤å‰ç¼–è¯‘openssl">3.1 äº¤å‰ç¼–è¯‘openssl</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> openssl-1.1.1b/</span><br><span class="line">$ ./config no-asm -shared --prefix=$(<span class="built_in">pwd</span>)/install</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°æ­¥éª¤åªæ˜¯ç”Ÿæˆäº†Makefile,è¿˜æ²¡æœ‰è®¾ç½®äº¤å‰ç¼–è¯‘å·¥å…·é“¾,éœ€è¦æ‰‹åŠ¨è®¾ç½®.<br>
ç”¨ç¼–è¾‘å™¨æ‰“å¼€Makefile,æœç´¢&quot;-m64&quot;,æ€»å…±æ‰¾åˆ°ä¸¤å¤„,åˆ é™¤ä¹‹.æœç´¢&quot;CROSS_COMPILE=â€œ,æ”¹ä¸º&quot;CROSS_COMPILE=arm-linux-gnueabihf-â€.<br>
æ¥ç€è¿›è¡Œç¼–è¯‘:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ make -j4</span><br></pre></td></tr></table></figure>
<p>è€å¿ƒç­‰å¾…ä¸€æ®µæ—¶å€™åå°±è¿˜å®Œæˆç¼–è¯‘,ç»§ç»­:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ make install</span><br></pre></td></tr></table></figure>
<p>ä¸€æ®µæ—¶é—´åå°±ä¼šå®Œæˆ.æ­¤æ—¶åœ¨å½“å‰ç›®å½•ä¸‹å°±ä¼šäº§ç”Ÿä¸€ä¸ª install æ–‡ä»¶å¤¹,ç¼–è¯‘å‡ºæ¥çš„äº§ç‰©å…¨éƒ¨åœ¨é‡Œé¢äº†.<br>
openssläº¤å‰ç¼–è¯‘å®Œæˆ.</p>
<h3 id="3-2-äº¤å‰ç¼–è¯‘ntp">3.2 äº¤å‰ç¼–è¯‘ntp</h3>
<p>ç”±äºntpä¾èµ–äºopenssl,æ‰€ä»¥å…ˆç®€å•ç²—æš´çš„å°†ç›¸å…³å¤´æ–‡ä»¶å¤åˆ¶åˆ°ntpæºç çš„includeæ–‡ä»¶å¤¹ä¸‹:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cp</span> -rf ~/work/openssl-1.1.1b/install/include/* ~/work/ntp-4.2.8p13/include</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥è¿›è¡Œntpçš„äº¤å‰ç¼–è¯‘:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/work/ntp-4.2.8p13/</span><br><span class="line">$ ./configure CC=arm-linux-gnueabihf-gcc LDFLAGS=-L/home/liuheng/Desktop/openssl-1.1.1b/install/lib --host=arm-linux-gnueabihf --prefix=$(<span class="built_in">pwd</span>)/install  --with-yielding-select=<span class="built_in">yes</span></span><br><span class="line">$ make -j4</span><br><span class="line">$ make install</span><br></pre></td></tr></table></figure>
<p>è€å¿ƒç­‰å¾…ä¸€æ®µæ—¶é—´å,ç¼–è¯‘å®Œæˆ,ç¼–è¯‘çš„äº§ç‰©åœ¨ç”Ÿæˆçš„ install/ æ–‡ä»¶å¤¹é‡Œ</p>
]]></content>
      <tags>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>ZYNQç§»æ¤ubuntu18.04</title>
    <url>/2019/03/11/ZYNQ%E7%A7%BB%E6%A4%8Dubuntu_18-04/</url>
    <content><![CDATA[<p>ç”±äºå·¥ä½œåŸå› ï¼Œéœ€è¦åœ¨xilinx zynq7000ç³»åˆ—çš„SOCä¸Šç§»æ¤ubuntu 18.04ï¼Œåœ¨æ­¤ï¼Œè®°å½•ç§»æ¤è¿‡ç¨‹ã€‚</p>
<p>æ“ä½œç³»ç»Ÿ: Ubuntu 18.04 LTS<br>
å¼€å‘æ¿  : MYIR Z-turn Board</p>
<span id="more"></span>
<h2 id="1-ä¸‹è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ">1.ä¸‹è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ</h2>
<p>é¦–å…ˆåˆ›å»ºå·¥ä½œè·¯å¾„:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> -p ~/ubuntu_rootfs</span><br><span class="line">$ <span class="built_in">cd</span> ~/ubuntu_rootfs</span><br><span class="line">$ <span class="built_in">mkdir</span> -p tmp</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ,è¿™é‡Œæˆ‘ç”¨çš„æ˜¯å®˜æ–¹çš„ä¸‹è½½åœ°å€,å¦‚æœä¸‹è½½é€Ÿåº¦å¾ˆæ…¢,ä¹Ÿå¯ä»¥ä»<a href="https://mirrors.tuna.tsinghua.edu.cn/">æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™</a>ä¸‹è½½å¯¹åº”ç‰ˆæœ¬.ç”±äºæˆ‘ä»¬çš„å¼€å‘æ¿æ˜¯armå¹³å°,æ‰€ä»¥ä¸‹è½½ <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu-cdimage/ubuntu-base/releases/18.04.4/release/ubuntu-base-18.04-base-armhf.tar.gz">ubuntu-base-18.04-core-armhf.tar.gz</a>.<br>
<em><strong>æ³¨æ„:ä¸‹è½½å®Œæˆåä¸€å®šè¦ç”¨rootæƒé™è§£å‹,ä¸”åŠ¡å¿…è§£å‹åˆ°linuxçš„åˆ†åŒº,å¦åˆ™æœ€ç»ˆç”Ÿæˆçš„ç‰ˆæœ¬åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šå‡ºç°å„ç§é—®é¢˜!!!</strong></em></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo su</span><br><span class="line">$ tar -xvf ubuntu-base-18.04-core-armhf.tar.gz -C ~/ubuntu_rootfs/tmp</span><br></pre></td></tr></table></figure>
<p>è§£å‹åå¾—åˆ°:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> tmp/</span><br><span class="line">bin   dev  home  media  opt   root  sbin  sys  var</span><br><span class="line">boot  etc  lib   mnt    proc  run   srv   tmp  usr</span><br></pre></td></tr></table></figure>
<br/>
<h2 id="2-å®‰è£…qemu-user-staticå·¥å…·">2.å®‰è£…qemu-user-staticå·¥å…·</h2>
<p>å…³äºQEMUå¯å‚è€ƒç™¾åº¦ç™¾ç§‘çš„ç®€ä»‹:<a href="https://baike.baidu.com/item/QEMU/1311178?fr=aladdin">QEMU</a>.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install qemu-user-static</span><br></pre></td></tr></table></figure>
<p>æ‹·è´qemu-arm-staticåˆ°åˆšåˆšè§£å‹å‡ºæ¥çš„ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cp</span> $(<span class="built_in">which</span> qemu-arm-static) ~/ubuntu_rootfs/tmp/usr/bin</span><br></pre></td></tr></table></figure>
<br/>
<h2 id="3-ç½‘ç»œé…ç½®">3.ç½‘ç»œé…ç½®</h2>
<p>ä¿®æ”¹æ ¹æ–‡ä»¶ç³»ç»Ÿçš„è½¯ä»¶æº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/ubuntu_rootfs/tmp</span><br><span class="line">$ sudo gedit etc/apt/source.list</span><br></pre></td></tr></table></figure>
<p>æˆ‘è¿™é‡Œç”¨çš„æ˜¯æ¸…åå¤§å­¦çš„è½¯ä»¶æº</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># deb cdrom:[Ubuntu 18.04 LTS _Xenial Xerus_ - Release amd64 (20160420.1)]/ xenial main restricted</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial main restricted</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-updates main restricted</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial universe</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-updates universe</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial multiverse</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-updates multiverse</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-security main restricted</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-security universe</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ xenial-security multiverse</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†åˆ¶ä½œæˆåŠŸçš„æ ¹æ–‡ä»¶ç³»ç»Ÿèƒ½å¤Ÿè”ç½‘,å¯ä»¥ç›´æ¥æ‹·è´æœ¬æœºçš„dnsé…ç½®æ–‡ä»¶åˆ°æ ¹æ–‡ä»¶ç³»ç»Ÿçš„ç›¸åº”ä½ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo <span class="built_in">cp</span> /etc/resolv.conf etc/resolv.conf</span><br></pre></td></tr></table></figure>
<br/>
<h2 id="4-æŒ‚åœ¨æ ¹æ–‡ä»¶ç³»ç»Ÿå¹¶chroot">4.æŒ‚åœ¨æ ¹æ–‡ä»¶ç³»ç»Ÿå¹¶chroot</h2>
<p>æˆ‘çš„æŒ‚è½½è¿‡ç¨‹ä½¿ç”¨shellè„šæœ¬å®ç°çš„,å…·ä½“å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">mnt</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;MOUNTING&quot;</span></span><br><span class="line">    sudo mount -t proc /proc <span class="variable">$&#123;2&#125;</span>proc</span><br><span class="line">    sudo mount -t sysfs /sys <span class="variable">$&#123;2&#125;</span>sys</span><br><span class="line">    sudo mount -o <span class="built_in">bind</span> /dev <span class="variable">$&#123;2&#125;</span>dev</span><br><span class="line">    sudo mount -o <span class="built_in">bind</span> /dev/pts <span class="variable">$&#123;2&#125;</span>dev/pts        </span><br><span class="line">    sudo <span class="built_in">chroot</span> <span class="variable">$&#123;2&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">umnt</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;UNMOUNTING&quot;</span></span><br><span class="line">    sudo umount <span class="variable">$&#123;2&#125;</span>proc</span><br><span class="line">    sudo umount <span class="variable">$&#123;2&#125;</span>sys</span><br><span class="line">    sudo umount <span class="variable">$&#123;2&#125;</span>dev/pts</span><br><span class="line">    sudo umount <span class="variable">$&#123;2&#125;</span>dev</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> == <span class="string">&quot;-m&quot;</span> ] &amp;&amp; [ -n <span class="string">&quot;<span class="variable">$2</span>&quot;</span> ] ;</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    mnt <span class="variable">$1</span> <span class="variable">$2</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> == <span class="string">&quot;-u&quot;</span> ] &amp;&amp; [ -n <span class="string">&quot;<span class="variable">$2</span>&quot;</span> ];</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    umnt <span class="variable">$1</span> <span class="variable">$2</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Either 1&#x27;st, 2&#x27;nd or bothparameters were missing&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;1&#x27;st parameter can be one ofthese: -m(mount) OR -u(umount)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;2&#x27;nd parameter is the full pathof rootfs directory(with trailing &#x27;/&#x27;)&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;For example: mount -m/media/sdcard/&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> 1st parameter : <span class="variable">$&#123;1&#125;</span></span><br><span class="line">    <span class="built_in">echo</span> 2nd parameter : <span class="variable">$&#123;2&#125;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>æŒ‚è½½æ­¥éª¤:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo ./mount.sh -m ~/ubuntu_rootfs/tmp/</span><br></pre></td></tr></table></figure>
<p>å¸è½½æ­¥éª¤:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo ./mount.sh -u ~/ubuntu_rootfs/tmp/</span><br></pre></td></tr></table></figure>
<br/>
<h2 id="5-å®‰è£…è½¯ä»¶">5.å®‰è£…è½¯ä»¶</h2>
<p>é¦–å…ˆéœ€è¦æ›´æ–°è½¯ä»¶æº:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get update</span><br></pre></td></tr></table></figure>
<p>ç”±äºubuntu coreåªåŒ…å«æœ€åŸºç¡€çš„è½¯ä»¶,æ‰€ä»¥éœ€è¦è‡ªè¡Œå®‰è£…å¸¸ç”¨çš„è½¯ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install python3 wireless-tools vim sudo net-tools iputils-ping iproute2</span><br><span class="line">$ apt-get -y install udev</span><br></pre></td></tr></table></figure>
<p>è¿˜éœ€è¦å®‰è£…å›¾å½¢æ“ä½œç•Œé¢,æˆ‘å®‰è£…çš„æ˜¯xfce4:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install xinit //startx</span><br><span class="line">$ apt-get install xdm //ç¯å¢ƒç®¡ç†å™¨</span><br><span class="line">$ apt-get install xfce4 //æ¡Œé¢ç¯å¢ƒ</span><br></pre></td></tr></table></figure>
<p>æ¢å¤Xfce4çš„é»˜è®¤é…ç½®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">rm</span> ~/.config/xfce4/xfconf/xfce-perchannel-xml/xfce4-panel.xml</span><br></pre></td></tr></table></figure>
<p>å®‰è£…åŒ…ç®¡ç†å™¨ ç½‘å¡ç®¡ç†æ¨¡å—</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install synaptic</span><br><span class="line">$ apt-get install ifupdown</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ä¸­æ–‡æ”¯æŒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install language-pack-zh-hant language-pack-zh-hans</span><br><span class="line">$ apt install -y --force-yes --no-install-recommends fonts-wqy-microhei</span><br><span class="line">$ apt install -y --force-yes --no-install-recommends ttf-wqy-zenhei</span><br><span class="line">ç„¶å</span><br><span class="line">$ dpkg-reconfigure locales</span><br><span class="line">é€‰zh UTF-8</span><br><span class="line">$ locale-gen en_US.UTF-8</span><br></pre></td></tr></table></figure>
<p>å®‰è£…Chrome</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ apt-get install chromium-browser chromium-browser-l10n</span><br><span class="line">é‡åˆ°chrome unlock keyring</span><br><span class="line">$ apt install seahorse</span><br><span class="line">ç»ˆç«¯è¾“å…¥ seahorse ç„¶åç‚¹å‡»Default lock,è®¾ç½®æ—§å¯†ç å,æ–°å¯†ç ä¸è¾“å…¥ç›´æ¥ç¡®è®¤,å¯ä»¥è§£å†³æ­¤é—®é¢˜</span><br></pre></td></tr></table></figure>
<p>å›¾å½¢ç•Œé¢çš„å¼€å¯ä¸å…³é—­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å–æ¶ˆè‡ªå¯</span><br><span class="line">$ update-rc.d -f gdm remove</span><br><span class="line"></span><br><span class="line">æ¢å¤è‡ªå¯</span><br><span class="line">$ update-rc.d gdm defaults</span><br></pre></td></tr></table></figure>
<br/>
<h2 id="6-ç”¨æˆ·é…ç½®">6.ç”¨æˆ·é…ç½®</h2>
<p>é¦–å…ˆè®¾ç½®rootå¯†ç :</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ passwd root</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ ç”¨æˆ·:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ adduser ubuntu</span><br></pre></td></tr></table></figure>
<p>ç»™æ–°æ·»åŠ çš„ç”¨æˆ·åˆ†é…æƒé™:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ vi /etc/sudoers</span><br><span class="line">åœ¨<span class="string">&quot;root ALL=(ALL) ALL&quot;</span>è¿™ä¸€è¡Œä¸‹é¢æ·»åŠ :</span><br><span class="line">ubuntu ALL=(ALL) ALL</span><br></pre></td></tr></table></figure>
<br/>
<h2 id="7-é…ç½®ä¸²å£">7.é…ç½®ä¸²å£</h2>
<p>å¿…é¡»é…ç½®ä¸²å£,å¦åˆ™æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿå,è¶…çº§ç»ˆç«¯ä¼šæ²¡æœ‰è¾“å‡º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ vi /etc/init/ttyPS0.conf</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–‡ä»¶å°†åœ¨å¯åŠ¨æ—¶é€šè¿‡UARTç«¯å£ç”Ÿæˆä¸€ä¸ªæ§åˆ¶å°,æˆ‘ä»¬éœ€è¦å°†è¯¥æ–‡ä»¶çš„å†…å®¹ä¿®æ”¹ä¸ºå¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">start on stopped rc or RUNLEVEL=[12345]</span><br><span class="line">stop on runlevel [!12345]</span><br><span class="line"></span><br><span class="line">respawn</span><br><span class="line"><span class="built_in">exec</span> /sbin/getty -L 115200 ttyPS0 vt102</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜éœ€è¦ç¼–è¾‘ /etc/fstab æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨å¯åŠ¨æ—¶æŒ‚è½½æˆ‘ä»¬çš„æ ¹æ–‡ä»¶ç³»ç»Ÿ.æˆ‘ä»¬çš„ /etc/fstab æ–‡ä»¶åº”å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/dev/mmc.blk0p2 / ext4    relatime,errors=remount-ro  0   1</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ“ä½œå…¨éƒ¨å®Œæˆå,é€€å‡ºæ–‡ä»¶ç³»ç»Ÿ:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<p>å¸è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ sudo ./mount.sh -u ~/ubuntu_rootfs/tmp/</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>ZYNQ</tag>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
        <tag>ubuntu ç§»æ¤</tag>
      </tags>
  </entry>
  <entry>
    <title>Buildroot ç¼–è¯‘å¤±è´¥è§£å†³æ–¹æ¡ˆ</title>
    <url>/2019/03/06/buildroot_error_solution/</url>
    <content><![CDATA[<p>åœ¨åµŒå…¥å¼linuxå¼€å‘è¿‡ç¨‹ä¸­äº¤å‰ç¼–è¯‘buildrootæ—¶ä¼šå‡ºç°å¾ˆå¤šé”™è¯¯å¯¼è‡´ç¼–è¯‘æ— æ³•ç»§ç»­è¿›è¡Œ,åœ¨æ­¤æ€»ç»“(â€œæŠ„è¢­â€,ğŸ˜œ)äº†ä¸€äº›é”™è¯¯è§£å†³æ–¹æ¡ˆä»¥å¤‡åç”¨.</p>
<span id="more"></span>
<h2 id="Error-1">Error 1 :</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdate.c:2497:7: error: format not a string literal</span><br></pre></td></tr></table></figure>
<h3 id="Reason">Reason :</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ç¼–è¯‘ç±»openwrt sdkæ—¶ï¼Œå‡ºç°ä¸ªgdate.cçš„é”™è¯¯ï¼Œä¸ç¼–è¯‘å™¨ç‰ˆæœ¬æœ‰å…³ï¼Œæ‰“ä¸ªpatchå°±å¥½</span><br></pre></td></tr></table></figure>
<h3 id="Solution">Solution:</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">* Returns: number of characters written to the buffer, or 0 the buffer was too small</span><br><span class="line">*/</span><br><span class="line">+<span class="comment">#pragma GCC diagnostic push</span></span><br><span class="line">+<span class="comment">#pragma GCC diagnostic ignored &quot;-Wformat-nonliteral&quot; </span></span><br><span class="line">+</span><br><span class="line">gsize</span><br><span class="line">g_date_strftime (gchar *s,</span><br><span class="line">gsize slen,</span><br><span class="line">@@ -2549,3 +2552,5 @@ g_date_strftime (gchar *s,</span><br><span class="line"><span class="built_in">return</span> retval;</span><br><span class="line"><span class="comment">#endif</span></span><br><span class="line">&#125;</span><br><span class="line">+</span><br><span class="line">+<span class="comment">#pragma GCC diagnostic pop</span></span><br></pre></td></tr></table></figure>
<p><br/></br></p>
<h2 id="Error-2">Error 2 :</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Unescaped left brace <span class="keyword">in</span> regex is illegal here <span class="keyword">in</span> regex; marked by &lt;-- HERE <span class="keyword">in</span> m/<span class="variable">$&#123; &lt;-- HERE ([^ \t=:+&#123;&#125;</span>]+)&#125;/ at xxxx/usr/bin/automake line 3939.</span><br></pre></td></tr></table></figure>
<h3 id="Reason-v2">Reason :</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">å‡ºç°çš„automakeæ­£åˆ™è¡¨è¾¾å¼é—®é¢˜ã€‚åŸå› æ˜¯Perlä¸æ”¯æŒä»¥å‰çš„å†™æ³•</span><br></pre></td></tr></table></figure>
<h3 id="Solution-v2">Solution:</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># $text =~ s/\$&#123;([^ \t=:+&#123;&#125;]+)&#125;/substitute_ac_subst_variables_worker ($1)/ge;</span></span><br><span class="line"><span class="variable">$text</span> =~ s/\$[&#123;]([^ \t=:+&#123;&#125;]+)&#125;/substitute_ac_subst_variables_worker (<span class="variable">$1</span>)/ge;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>åµŒå…¥å¼å¼€å‘</tag>
      </tags>
  </entry>
</search>
